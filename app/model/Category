<?php
class Category extends Model
{
    public function __construct()
    {
        parent::__construct('categories');
    }

    public function getWithProductCount()
    {
        $query = "SELECT c.*, COUNT(p.id) as product_count 
                 FROM categories c 
                 LEFT JOIN products p ON c.id = p.category_id 
                 GROUP BY c.id 
                 ORDER BY c.name";
        $stmt = $this->db->prepare($query);
        $stmt->execute();
        return $stmt->fetchAll(PDO::FETCH_ASSOC) ?: [];
    }
}
